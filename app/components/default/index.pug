extends ../common/main
block content
    .container
        .row
            .col-lg-4.offset-lg-4
                form.text-center.border.border-inverse.p-5.signin_form
                    p.h4.mb-4 Sign in
                    p(id="form-alert", class="alert alert-danger", style="display:none;")
                    input#email.form-control.mb-4(type='text', placeholder='Username')
                    input#password.form-control.mb-4(type='password', placeholder='Password')
                    .d-flex.justify-content-around
                        div
                            .custom-control.custom-checkbox
                                input#defaultLoginFormRemember.custom-control-input(type='checkbox')
                            label.custom-control-label(for='defaultLoginFormRemember') Remember me
                        div
                            a(href='') Forgot password?
                    button.btn.btn-info.btn-block.my-4(type='submit') Sign in
                    p
                        | Not a member?
                        a(href='/users') Register
                    p
                        a(href="/community") Go to community
    script.

        let host_url = '#{ host }';
        
        $('form').submit(function(e) {
            e.preventDefault();
            
            let email = ($('#email').val()).trim();
            let password = $('#password').val();
            
            if (email == "")
            {
                $('#form-alert').show();
                $('#form-alert').html("Username can't be blank");
                return false;
            }
            
            $('#form-alert').hide();
            $('#form-alert').html('');

            $.ajax({
                type: 'POST',
                url: '//' + host_url + '/users/login',
                contentType:  'application/json; charset=utf-8',
                dataType: 'json',
                data: JSON.stringify({ 'username': email, 'password': password }),
                success: function(response){
                    window.location.replace('//' + host_url + '/community')
                },
                failure: function(error) {
                    
                }
            });
        });
